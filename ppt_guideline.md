[아래는 저희 팀이 제시한 프로젝트의 구현 결과와 기술을 설명하는 발표 자료입니다. 대본을 읽고 어색한 부분이나 맥락, 그리고 저희 서비스에 해당되지 않는 기술이나 조금의 오류가 있다면 수정해주고, 빠진 부분이 있다면 추가해주세요. 저희의 페르소나와 대본은 아래와 같습니다.]

[페르소나 노후인씨]
이름 : 노후인
생년월일: 1966년 3월 24일 (은퇴를 앞둔 50대 후반~60대 초반 설정)
성별: 남성 (Gender.M)
연락처: 010-3549-2346
투자 성향: 적극투자형 (InvestmentTendancy.적극투자형)
마이데이터 가입 여부: 가입 완료 (true)
2. 보유 자산 현황 노후인 님은 예금, 적금, 투자, 부동산 등 다양한 자산을 보유하고 있으며, 대출도 일부 가지고 있습니다.
수시입출금 (CURRENT): 총 500만 원
200만 원 (은행코드: 020 - 우리은행 추정)
300만 원 (은행코드: 002 - 산업은행 추정)
저축/예적금 (SAVING): 총 6,000만 원
4,000만 원 (은행코드: 020 - 우리은행 추정)
2,000만 원 (은행코드: 081 - 하나은행 추정)
투자 자산 (INVEST): 1,000만 원 (기관코드: 240 - 삼성증권 추정)
연금 자산 (PENSION): 1억 5,000만 원 (기관코드: 001)
자동차 (AUTOMOBILE): 3,000만 원
부동산 (REAL_ESTATE): 12억 원
대출 (LOAN): 5억 원 (기관코드: 011 - 농협 추정)
3. 연금 상세 정보 보유 중인 연금 자산(1억 5천만 원)에 대한 상세 내역입니다.
상품명: 우리은행 개인형IRP
연금 유형: DC (확정기여형)
총 원금: 1억 5,000만 원
개인 납입금(당해): 1,000만 원 (2023년 기준)
누적 개인 납입금: 5,000만 원
4. 관심 키워드 노후인 님은 다음 ID에 해당하는 키워드 5가지를 관심사로 설정했습니다.
연결된 키워드 ID: 1, 2, 6, 12, 15

[대본, 숫자는 유지해주세요. 페이지 번호입니다.]

1. 노후인씨는 회원가입에서 자금 운용 성향과 은퇴 후 희망 키워드를 기입하였습니다. 이는 사용자 개인화된 자산설계를 위해, **Cold Start(초기 데이터 부족) 문제**를 해결하는 기초적인 정보이며, 페르소나를 구체화 하기 위한 첫 번째 단계였습니다.
자금 운용 성향은 펀드와 같은 투자 자산 혹은 이율에 따른 상품을 추천할 때 중요한 지표가 되며, 은퇴 후 희망 키워드는 페르소나가 원하는 삶, 관심있는 분야를 구체화하여 상품과 연결짓기 위해 수집합니다.

2. 본격적인 자산 설계 기능에서는, 더 디테일한 노후인씨의 자산 정보와 목표를 설정하게 됩니다.
생활비와 고정소득, 목표금액과 기간, 은퇴 여부 등을 받게 되며, 이를 마이데이터로 불러온 현재 자산과 함께 종합하여, 자산 설계를 위한 최종적인 페르소나를 구체화하게 됩니다.

3. (넘기고)

4. 저희는 노후인씨가 누구인가 알아내는 과정인 Know Who를 거쳤습니다. (넘기고) 이제 How, 어떻게 고객에게 딱 맞는 자산 설계 방법을 제시할 것인지 알려드리겠습니다.

5. 자산 설계 세부 기능에는, **자산 포트폴리오 분석**과 **AI 자산 관리 상담 챗봇** 두 가지가 있습니다.

6. 먼저, 시연 영상을 보여드리겠습니다. 시간 관계상 2배속인 점 양해 부탁드립니다.

7. 비즈니스 로직이 바탕이 되는 포트폴리오 상단부에는, 목표 금액 대비 현재 자산의 비율과, 목표 금액 달성 분기별 알림 문구가 존재합니다.

8. 또한 사용자의 자산과 키워드를 기반으로 한 사용자 유형을 **예금형**과 **투자형(적금형)**으로 나누고, 상품에 고객이 현재 가입했을 때의 예상 금액을 로직으로 구현하였습니다.

9. 예금형과 투자형, 두 유형의 판별은 재무 건전성, 나이 및 가계정보, 투자 성향 및 목표를 종합한 점수를 바탕으로 정해집니다. 각 유형에 맞는 상품 컴포넌트를 배치하였고, (넘기고) 상품 페이지로 이동이 가능하여 가입 유도가 가능합니다.

10. 포트폴리오 하단부에는 RAG(검색 증강 생성)를 통한 금융 상품 추천 카드가 배치됩니다. 카드에는 각각 추천 이유와, 상품 정보 등이 포함됩니다.

11. RAG를 위한 예적금, 펀드, 연금저축 데이터는 **금융위원회**와 **한국벤처투자**, **금융감독원**의 Open API를 통해 수집하였습니다.

12. 금융 상품의 신선도와 정합성을 위해 **Apache Airflow**를 이용하여 ETL 파이프라인을 구현하고 서버에 구축하였습니다. 데이터는 파이프라인을 거쳐 **MongoDB Atlas**에 적재되고, **Vector Search**에 쓰이게 됩니다.

13. 저희가 금융상품 DB를 MongoDB Atlas로 선택한 이유는, 첫 번째로 JSON 포맷 데이터를 Document 형태로 저장하여 **Schema-less**한 유연성을 가지며 복잡한 Join 연산이 불필요하다는 점입니다. 또한, 금리와 같은 중첩된 JSON 배열 내부의 필드 검색이 용이하다는 점이 있습니다.
원본 데이터와 임베딩 벡터를 같이 저장하여 별도 벡터 DB 구축이 필요하지 않고, 키워드 검색과 시맨틱 검색을 결합한 **Hybrid Search**가 가능합니다. 마지막으로, 자체적으로 Vector Search Index를 지원하여 강력한 RAG 성능이 보장됩니다.

14. 파이프라인의 형태는 다음과 같습니다. 하나의 DAG 안에는 추출(Extract), 전처리(Transform), 임베딩(Embed), 적재(Load)의 Task가 순차적으로 수행됩니다. 상품 수집 이후에는 데이터 신선도 유지를 위해 만료 상품 삭제를 진행하고, 임베딩 필드가 누락된 상품을 재임베딩하는 과정을 거칩니다.

15. 해당 DAG들은 트래픽이 적은 심야 시간대인 **매일 새벽 3시**에 순차적으로 실행되게 됩니다.

16. 약 1,000여 개의 상품 데이터들은 구글의 Gemini Embedding 모델을 통해 각각 **768차원**의 벡터로 변환됩니다.

17. 이렇게 임베딩된 금융상품이 어떤 방식으로 사용자에게 추천되는지 알아보겠습니다.
클라이언트에서 FastAPI를 통해 상품 추천 API를 호출하면, Python ORM 라이브러리인 **SQLAlchemy**를 통해 MySQL의 유저 테이블을 조회합니다. 서비스에 필요한 노후인씨의 정보를 추출하여 텍스트화한 뒤, Gemini Embedding을 통해 상품과 동일한 차원으로 벡터화를 진행합니다. 사용자의 벡터와 상품 벡터 간의 **Cosine Similarity(코사인 유사도)**를 통해 Vector Search를 진행하게 됩니다. Gemini API를 이용해 LLM RAG Chain으로 후보 상품군을 추출하면, **LangGraph의 StateGraph**를 통해 후보 상품군을 검증 및 전처리하고 클라이언트에서 이용할 수 있도록 서빙합니다.

18. 금융 상품 추천에서 더 나아가, 저희는 단순 정보 전달성 챗봇이 아닌 사용자와 상호작용하는 **AI 자산 관리 상담 챗봇**을 구현하였습니다.
저희 상담 챗봇에는 크게 4가지 기능이 있으며, 설명과 함께 말씀드리겠습니다.

19. 첫 번째로 유저별 ID와 세션 ID를 통한 **채팅방 관리**입니다. 모든 챗봇의 대화 기록은 MongoDB에 적재되며, 채팅을 남긴 주체가 챗봇(assistant)인지 사용자(user)인지 판별하는 Role과 채팅 내용이 기록됩니다.

20. 채팅 내역 조회 API를 구현하였고, **Cursor-based Pagination** (또는 Offset 기반)을 통해 최근 채팅을 5개씩 효율적으로 조회하게 됩니다.

21. 영상처럼 로그아웃을 하고 돌아와도 채팅 내역은 유지되는 것을 볼 수 있고, 대화 내용은 **무한 스크롤(Infinite Scroll)**을 통해 호출되게 되어 초기 렌더링 속도 개선과 DB 조회 과부하를 막을 수 있습니다.

22. 두 번째로 **LLM 답변 기반 키워드 재구성** 및 상품 가입 유도가 가능합니다. 시스템 프롬프트로 답변 생성 시 명시적인 키워드 생성을 요청하면, 답변 스트리밍 중에 키워드를 실시간으로 추출합니다. (넘기며)

23. 답변 생성이 끝나면, 버퍼에 담긴 텍스트에서 **정규표현식(Regex)**으로 키워드 태그만 추출하여 프론트엔드에 전송하고, 이를 UI 버튼으로 재구성합니다.

24. 동일한 로직으로 '상품 추천' 시에는 상품 카드를 렌더링하여 하이퍼링크를 통한 가입 유도를 수행할 수 있습니다.

25. 이렇게 재구성한 키워드를 통하여 사용자는 폭넓은 금융 지식과 자산 관리 방법을 꼬리에 꼬리를 물고 학습할 수 있으며, 자유도는 높되 금융 도메인 한정의 깊이 있는 정보 제공이 가능합니다.

26. 세 번째 기능은 사용자의 피드백을 바탕으로 상품 추천을 실시간으로 **리랭킹(Re-ranking)** 하는 것입니다.
사용자가 남긴 좋아요/싫어요 피드백을 기록하고, 다음 추천 시에 이를 실시간으로 반영하여 추천 결과의 품질을 지속적으로 개선합니다.

27. 노후인씨가 만약 "연금저축 추천해줘"라고 질문했을 때, 서비스에서는 채팅 로그 컬렉션에서 노후인씨의 과거 피드백을 조회하고, 상품 ID를 기준으로 좋아요한 상품과 싫어요 한 상품 집합을 분류합니다. 이를 통해 관심 없는 상품은 필터링하고 선호하는 상품은 상단에 노출하는 것이 가능합니다. 일정상 더 고도화하지는 못하였지만, 추후 **Collaborative Filtering(협업 필터링)**을 통해 비슷한 성향의 사용자들의 피드백을 반영하는 것으로 확장이 가능하겠습니다.

28. 네 번째로, 민감 정보 유출을 막기 위한 **프롬프트 인젝션(Prompt Injection) 차단 조치를 진행하였습니다. 국제 웹 보안 표준 기구인 **OWASP의 LLM Top 10**에서도 가장 강조하고 있는 프롬프트 인젝션은, LLM 모델들이 널리 사용됨에 따라 가장 치명적인 보안 취약점으로 지적되고 있습니다.

29. 이를 방지하기 위해 시스템 프롬프트와 서비스 로직에 **보안에 위협이 되는 키워드(예: 시스템 설정 노출, 관리자 권한 요청 등)**를 차단하는 블랙리스트 조치를 하였습니다. 또한, 금융 관련 키워드와 비금융 키워드를 구분하여 비금융 질문(예: 날씨, 유머)에는 답변하지 않도록 예외 처리 로직을 추가하였습니다.

30. 저희 노후하우는 **금융소비자 보호법의 6대 판매 원칙**을 준수하도록 설계되었습니다.

31. 펀드와 같은 투자 자산 추천 시에는 **"원금 손실 가능성"**을 반드시 명시하도록 시스템 프롬프트에 지시하였고, "확실한 수익", "보장된"과 같은 **단정적 표현** 대신 "기대 수익률", "과거 실적" 같은 중립적 표현을 쓰도록 강제하였습니다. 적합성 원칙에 따라 고객 성향에 맞지 않는 고위험 상품은 추천 순위에서 배제됩니다.

32. 부가 기능으로는 **포트폴리오 분석**을 요청하면, 마크다운 표를 통해 자산 비중을 시각화해주고, 나이와 은퇴 시점에 맞춘 자산 증식 방안을 3가지 포인트로 자세히 제시해줍니다. (넘기고)

33. 직접 노후하우 사용자가 되어 시나리오기반 테스팅을 진행하였으며, 약 53개의 테스트 케이스에서 약 92%의 성공률을 보였습니다. 특히 상품 추천 테스팅은 모두 통과했으며, Recall@K 지표 또한 100%가 나왔습니다.

34. 마지막으로 사용자 질문 키워드를 분석하여, 노후하우의 다른 서비스인 '연금 관리', '내 주변 일자리 찾기', '상속 계획' 등의 기능으로 **Feature Navigation(기능 유도)** 가이드를 제공합니다. 마침 노후인씨가 연금 기능을 추천받았으니, 조원희 님께 다시 기능 소개를 넘기겠습니다.
.
